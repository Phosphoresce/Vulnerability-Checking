#!/bin/bash
case "$1" in
	v)	echo -e '\n'; openssl version -a
		echo ''
		;;
	c)	echo -e '\nStatus: '; openssl s_client -connect $2:$3 -tlsextdebug 2>&1| grep 'server extension "heartbeat" (id=15)' || echo "Most likely safe."
		echo ''
		;;
	cl)	python ssltest.py top-1m.csv $2
		;;
	p)	apt-get install openssl
		;;
	r)	wget "https://www.openssl.org/source/openssl-1.0.1j.tar.gz"; tar xzf openssl-1.0.1j.tar.gz; cd openssl-1.0.1j; ./config -DOPENSSL_NO_HEARTBEATS; make depend; make all
		;;
	b)	./bashcheck
		;;
	*)	echo "Usage: [options: v c cl p r b][aux options]"
		echo "v - returns version information"
		echo "c - tests remote/local for heartbleed extension"
		echo "    opts:[host] [port]"
		echo "cl- batch testing of remote hosts"
		echo "	  opts:$number of hosts to test"
		echo "p - uses your package manager to update openssl"
		echo "r - compiles specified version with -DOPENSSL_NO_HEARTBEATS"
		echo "	  opts:[version]"
		echo "b - tests for shellshock vulnerability"
		;;
esac
